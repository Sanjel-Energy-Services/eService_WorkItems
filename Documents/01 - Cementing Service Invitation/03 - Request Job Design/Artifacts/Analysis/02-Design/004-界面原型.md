# Program Request Management 系统原型设计文档

## 1. 文档概述

### 1.1 设计背景
本原型设计基于**模式驱动的界面原型方法论**，在AI辅助开发全周期中，为Program Request Management系统创建可维护、可扩展的界面原型。

### 1.2 AI辅助开发说明
- **开发阶段**：需求分析、界面设计、开发实现、测试验证
- **AI工具**：DeepSeek/Copilot辅助代码生成、模式分析、一致性检查
- **信息留痕**：所有设计决策、模式分析、变更记录均文档化保存

---

## 2. 参与者分析与界面规划

### 2.1 参与者角色映射

```mermaid
classDiagram
    direction TB
    
    class Sales_Dispatch {
        <<businessActor>>
        +主要目标: 快速提交程序请求并跟踪状态
        +核心需求: 简单提交、状态透明、及时通知
        +技术能力: 业务用户
    }
    
    class Engineer {
        <<actor>>
        +主要目标: 高效处理分配的程序设计任务
        +核心需求: 清晰任务分配、版本管理、评审流程
        +技术能力: 技术专家
    }
    
    class Manager_Engineering {
        <<actor>>
        +主要目标: 监控工作负载和审批关键请求
        +核心需求: 全局视图、审批效率、资源优化
        +技术能力: 管理用户
    }
    
    class Director_VP {
        <<actor>>
        +主要目标: 战略监督和合规审批
        +核心需求: 高层审批、数据洞察、合规保证
        +技术能力: 决策层
    }
    
    class Approvers {
        <<actor>>
        +主要目标: 质量保证和标准符合性
        +核心需求: 清晰评审任务、注释工具、决策支持
        +技术能力: 领域专家
    }
    
    class Operations_Field {
        <<actor>>
        +主要目标: 获取批准程序并执行
        +核心需求: 快速访问、搜索功能、只读视图
        +技术能力: 现场用户
    }
```

### 2.2 参与者专属界面组设计

```mermaid
classDiagram
    direction TB
    
    class Sales_界面组 {
        +请求提交界面
        +请求状态跟踪界面
        +程序文档下载界面
        +设计原则: 简洁直观、状态透明
    }
    
    class Engineer_界面组 {
        +任务收件箱界面
        +程序设计工作台
        +版本管理界面
        +评审提交界面
        +设计原则: 功能完整、操作高效
    }
    
    class Manager_界面组 {
        +工作负载监控界面
        +审批工作台
        +分配管理界面
        +报表分析界面
        +设计原则: 信息全面、决策支持
    }
    
    class Director_界面组 {
        +高层审批界面
        +战略仪表板
        +合规监控界面
        +设计原则: 关键指标、快速决策
    }
    
    class Approver_界面组 {
        +评审任务界面
        +注释工具界面
        +审批历史界面
        +设计原则: 评审高效、注释清晰
    }
    
    class Operations_界面组 {
        +程序库搜索界面
        +程序文档查看器
        +现场反馈界面
        +设计原则: 快速访问、只读优化
    }
    
    Sales_Dispatch --> Sales_界面组 : 使用
    Engineer --> Engineer_界面组 : 使用
    Manager_Engineering --> Manager_界面组 : 使用
    Director_VP --> Director_界面组 : 使用
    Approvers --> Approver_界面组 : 使用
    Operations_Field --> Operations_界面组 : 使用
```

---

## 3. 状态模式驱动的界面设计

### 3.1 程序请求生命周期状态映射

```mermaid
classDiagram
    direction LR
    
    class ProgramRequestState {
        <<lifecycleState>>
        +OpenState
        +ReceivedState
        +UnacknowledgedState
        +AcknowledgedState
        +PendingState
        +InProgressState
        +SentForReviewState
        +AwaitingReviewState
        +ReviewedState
        +SentForApprovalState
        +AwaitingApprovalState
        +ApprovedState
        +SentToSalesState
        +CompletedState
    }
    
    class 请求提交界面 {
        +客户信息表单
        +服务线选择
        +复杂度矩阵评估
        +附件上传区域
        +提交按钮
        +界面状态: 可编辑、可提交
        +对应业务状态: OpenState
    }
    
    class 工程师工作台 {
        +程序设计区域
        +版本控制面板
        +评审提交按钮
        +时间跟踪显示
        +界面状态: 设计进行中 / 已确认
        +对应业务状态: AcknowledgedState, InProgressState
    }
    
    class 评审工作台 {
        +程序文档查看器
        +评审注释工具
        +批准/拒绝按钮
        +评审历史面板
        +界面状态: 评审待处理 / 评审中 / 已完成
        +对应业务状态: SentForReviewState, AwaitingReviewState, ReviewedState
    }
    
    class 审批工作台 {
        +多级审批视图
        +合规检查列表
        +批量审批工具
        +审批流程可视化
        +界面状态: 审批待处理 / 审批中 / 已通过
        +对应业务状态: SentForApprovalState, AwaitingApprovalState, ApprovedState
    }
    
    class 状态跟踪界面 {
        +可视化时间轴
        +当前状态指示器
        +下一步操作提示
        +通知历史记录
        +界面状态: 状态动态更新 (含过渡状态)
        +对应业务状态: 全部生命周期状态 (含 Unacknowledged, SentForReview, SentForApproval)
    }
    
    ProgramRequestState --> 请求提交界面 : 状态映射
    ProgramRequestState --> 工程师工作台 : 状态映射
    ProgramRequestState --> 评审工作台 : 状态映射
    ProgramRequestState --> 审批工作台 : 状态映射
    ProgramRequestState --> 状态跟踪界面 : 状态映射
```

### 3.2 状态驱动的界面组件设计

```mermaid
classDiagram
    direction LR
    
    class 程序状态指示器 {
        +当前状态: ProgramRequestState
        +状态图标: Icon
        +状态描述: String
        +预计完成时间: DateTime
        +下一步提示: String
        +渲染状态显示()
        +更新状态(新状态)
    }
    
    class 复杂度矩阵指示器 {
        +矩阵颜色: CMColor
        +颜色图标: ColorBadge
        +审批要求描述: String
        +所需审批者列表: List~ApproverRole~
        +渲染矩阵显示()
        +更新颜色(新颜色)
    }
    
    class 时间跟踪面板 {
        +各阶段时间戳: Map~State,DateTime~
        +阶段持续时间: Map~State,TimeSpan~
        +SLA状态指示: SLABadge
        +超时预警提示: Alert
        +计算阶段时间()
        +检查SLA合规()
    }
    
    class 审批流程可视化 {
        +审批步骤列表: List~ApprovalStep~
        +当前步骤索引: Integer
        +审批者状态: Map~Approver,Status~
        +渲染审批流程()
        +更新审批状态()
    }
    
    class ProgramRequestState {
        <<lifecycleState>>
        +getAvailableOperations() List~ProgramOperation~
        +getRequiredApprovals() List~ApprovalType~
        +getNextStates() List~ProgramRequestState~
        +getSLARequirements() SLARequirement
        +isTerminal() Boolean
    }
    
    程序状态指示器 --> ProgramRequestState : 状态显示
    复杂度矩阵指示器 --> ProgramRequestState : 审批需求 (颜色→审批路径)
    时间跟踪面板 --> ProgramRequestState : 时间跟踪
    审批流程可视化 --> ProgramRequestState : 流程显示 (含过渡状态)
```

**审批颜色与路径补充说明**：
| 矩阵颜色 | 路径阶段 | 对应状态 | 说明 |
|----------|----------|----------|------|
| Green | 同级评审 | SentForReviewState → AwaitingReviewState → ReviewedState | 仅同行评审，无管理审批 |
| Yellow | 经理/组长评审 | ReviewedState → SentForApprovalState → AwaitingApprovalState | 经理审核性质为评审而非最终双层审批 |
| Red | 经理批准 | ReviewedState → SentForApprovalState → AwaitingApprovalState → ApprovedState | 经理直接最终批准 |
| Black | 经理+总监/VP批准 | ReviewedState → SentForApprovalState → AwaitingApprovalState (经理) → SentForApprovalState(二次) → AwaitingApprovalState(总监/VP) → ApprovedState | 多级串行审批 |

> 注：为减少界面复杂度，Yellow不再拆分“评审/批准”双层；Black在组件中以分段步骤显示。

---

## 4. 业务流模式驱动的界面导航

### 4.1 主要业务流程界面导航

```mermaid
flowchart TD
    A[📧 请求提交界面] --> B{提交方式}
    B -->|邮件转发| C[📋 自动创建请求]
    B -->|门户表单| D[✍️ 手动填写表单]
    
    C & D --> E[🆔 生成Program ID]
    E --> F[👤 自动分配工程师]
    F --> G[📊 设置优先级]
    G --> H[💻 工程师工作台]
    
    H --> I{设计完成}
    I -->|发送评审| J[👥 评审工作台]
    I -->|需要修改| H
    
    J --> K{评审结果}
    K -->|通过| L[✅ 发送审批]
    K -->|拒绝| H
    
    L --> M[🔄 审批工作台]
    M --> N{审批结果}
    N -->|通过| O[📤 发送销售]
    N -->|拒绝| H
    
    O --> P[💰 定价处理]
    P --> Q[📁 程序归档]
    
    classDef submission fill:#e8f5e9,stroke:#2e7d32
    classDef design fill:#e3f2fd,stroke:#1565c0
    classDef review fill:#fff3e0,stroke:#ff6f00
    classDef approval fill:#fce4ec,stroke:#c2185b
    
    class A,B,C,D submission
    class E,F,G,H design
    class I,J,K review
    class L,M,N approval
```

### 4.2 复杂度矩阵驱动的审批流程

```mermaid
sequenceDiagram
    participant S as Sales界面
    participant E as Engineer界面
    participant R as Review界面
    participant M as Manager界面
    participant D as Director界面
    
    Note over S,D: 基于复杂度矩阵的审批流程界面交互
    
    S->>E: 提交程序请求(Green矩阵)
    E->>E: 设计程序
    E->>R: 发送同行评审(Green)
    R->>E: 评审通过
    E->>S: 返回批准程序
    
    S->>E: 提交程序请求(Yellow矩阵)
    E->>E: 设计程序
    E->>M: 发送经理评审(Yellow)
    M->>E: 经理批准
    E->>S: 返回批准程序
    
    S->>E: 提交程序请求(Red矩阵)
    E->>E: 设计程序
    E->>M: 发送经理审批(Red)
    M->>D: 转交总监审批(Red)
    D->>M: 总监批准
    M->>E: 审批通过
    E->>S: 返回批准程序
    
    S->>E: 提交程序请求(Black矩阵)
    E->>E: 设计程序
    E->>M: 发送经理审批(Black)
    M->>D: 转交VP审批(Black)
    D->>M: VP批准
    M->>E: 审批通过
    E->>S: 返回批准程序
```

---

## 5. 参与者专属界面设计要点

### 5.1 Sales/Dispatch界面设计

```mermaid
classDiagram
    direction LR
    
    class Sales界面原则 {
        +提交简单: 邮件转发或简单表单
        +状态透明: 实时可视化跟踪
        +通知及时: 关键状态变化提醒
        +文档易访问: 一键下载批准程序
    }
    
    class 请求提交界面 {
        +邮件转发入口突出
        +快速表单最小字段
        +附件拖拽上传
        +客户信息自动补全
        +设计目标: 30秒内完成提交
    }
    
    class 状态跟踪界面 {
        +可视化进度条
        +当前处理者显示
        +预计完成时间
        +SLA状态指示
        +设计目标: 一眼了解请求状态
    }
    
    class 程序库界面 {
        +搜索过滤突出
        +程序文档预览
        +批量下载工具
        +收藏常用程序
        +设计目标: 快速找到历史程序
    }
    
    Sales界面原则 --> 请求提交界面 : 指导设计
    Sales界面原则 --> 状态跟踪界面 : 指导设计
    Sales界面原则 --> 程序库界面 : 指导设计
```

### 5.2 Engineer工作台设计

```mermaid
classDiagram
    direction LR
    
    class Engineer界面原则 {
        +任务集中: 统一收件箱管理
        +工具集成: 设计工具无缝衔接
        +版本控制: 自动保存和历史追溯
        +协作高效: 评审审批流程优化
    }
    
    class 任务收件箱 {
        +优先级排序显示
        +公司映射自动分配
        +截止日期醒目提示
        +批量操作支持
        +设计目标: 高效任务管理
    }
    
    class 程序设计工作台 {
        +集成设计工具
        +模板快速应用
        +版本对比视图
        +自动保存机制
        +设计目标: 专注程序设计
    }
    
    class 评审协作面板 {
        +评审任务清单
        +注释讨论线程
        +变更追踪显示
        +一键重新提交
        +设计目标: 顺畅评审协作
    }
    
    Engineer界面原则 --> 任务收件箱 : 指导设计
    Engineer界面原则 --> 程序设计工作台 : 指导设计
    Engineer界面原则 --> 评审协作面板 : 指导设计
```

---

## 6. AI辅助开发实施指南

### 6.1 开发阶段AI应用规划

```mermaid
flowchart TD
    A[🤖 AI辅助开发全周期] --> B[📋 需求分析阶段]
    A --> C[🎨 界面设计阶段]
    A --> D[💻 开发实现阶段]
    A --> E[✅ 测试验证阶段]
    
    B --> B1[模式识别与分析]
    B --> B2[用例生成与验证]
    B --> B3[一致性检查]
    
    C --> C1[组件库生成]
    C --> C2[布局优化建议]
    C --> C3[交互模式验证]
    
    D --> D1[代码自动生成]
    D --> D2[模式实现验证]
    D --> D3[性能优化建议]
    
    E --> E1[测试用例生成]
    E --> E2[用户体验评估]
    E --> E3[模式一致性测试]
    
    B1 & C1 & D1 & E1 --> F[📊 开发过程留痕]
    F --> G[🔍 质量审计跟踪]
```

### 6.2 信息留痕与审计要求

**AI辅助开发记录表**
| 阶段 | AI工具 | 输入内容 | 输出结果 | 人工验证 | 决策依据 | 时间戳 |
|------|--------|----------|----------|----------|----------|--------|
| 需求分析 | DeepSeek | FRD文档 | 参与者分析 | ✅ 已验证 | 模式一致性 | 2026-01-20 10:00 |
| 界面设计 | Copilot | 状态模式 | 组件设计 | ✅ 已验证 | 用户体验原则 | 2026-01-20 11:30 |
| 代码生成 | Copilot | 组件规范 | C#代码 | ⏳ 待验证 | 技术架构标准 | 2026-01-20 14:15 |

---

## 7. 原型验证与质量保证

### 7.1 模式一致性检查清单

- [ ] **状态一致性**：界面状态与程序请求状态机是否完全匹配
- [ ] **审批流程完整性**：所有复杂度矩阵路径都有对应界面流程
- [ ] **角色权限适配**：各参与者界面功能与权限要求一致
- [ ] **业务流覆盖**：界面导航覆盖所有业务场景路径
- [ ] **通知机制**：关键状态变化都有界面反馈和通知

### 7.2 AI辅助开发质量指标

```mermaid
flowchart LR
    A[📊 AI开发质量] --> B[🎯 模式一致性]
    A --> C[⚡ 开发效率]
    A --> D[🔧 代码质量]
    A --> E[👥 用户体验]
    
    B --> B1[状态模式匹配度]
    B --> B2[业务流覆盖度]
    B --> B3[角色权限符合度]
    
    C --> C1[代码生成准确率]
    C --> C2[组件复用率]
    C --> C3[开发时间节省]
    
    D --> D1[自动化测试通过率]
    D --> D2[性能基准达标率]
    D --> D3[安全规范符合度]
    
    E --> E1[任务完成成功率]
    E --> E2[操作效率提升]
    E --> E3[用户满意度]
    
    B1 & C1 & D1 & E1 --> F[📈 综合质量评分]
    F --> G[🔄 持续改进循环]
```

## 8. 总结

本系统原型设计文档基于模式驱动的方法论，为Program Request Management系统提供了：

### 8.1 核心价值
- **业务技术一致性**：界面设计与业务需求精确对应
- **开发指导明确**：为AI辅助开发提供清晰规范
- **用户体验优化**：基于参与者角色的专属设计
- **变更可追溯**：完整的模式映射支持需求变更

### 8.2 AI辅助开发优势
1. **模式识别加速**：快速分析业务模式并生成对应界面
2. **一致性保证**：自动化检查设计模式的一致性
3. **开发效率提升**：基于模式的代码自动生成
4. **质量可度量**：建立客观的质量评估指标

### 8.3 实施建议
1. **渐进式实施**：按参与者角色分阶段开发验证
2. **持续验证**：每个迭代周期进行模式一致性检查
3. **反馈循环**：建立用户反馈到模式优化的闭环
4. **知识沉淀**：将AI辅助开发经验转化为可复用模式

此原型设计为AI辅助开发提供了系统化的框架，确保在提高开发效率的同时，保持系统的可维护性和用户体验质量。
